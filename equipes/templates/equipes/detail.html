{% extends 'base.html' %}
{% load static %}

{% block title %}
{{ equipe.nome }}
{% endblock title %}

{% block content %}
<h2>Página da Equipe {{ equipe.nome }} </h2>

<section class="dados-de-equipe">
    <img src="{{ equipe.logo }}" alt="Logo da equipe {{ equipe.nome}}">
    <ul>
        <li>Nome: {{ equipe.nome }}</li>
        <li>Descrição: {{ equipe.descricao }}</li>
        {% if perms.equipes.change_equipe %}
            <li><a href="{% url 'equipes:update' equipe.id %}">Editar</a></li>
        {% endif%}
        {% if perms.equipes.delete_equipe %}
            <li><a href="{% url 'equipes:delete' equipe.id %}">Apagar</a></li>
        {% endif%}
    </ul>

</section>

<hr>

<section>

    <div class="console-log">
        <div class="log-content">
            <div class="--noshadow" id="demoEvoCalendar"></div>
        </div>
    </div>

    {% if perms.equipes.change_equipe %}
        <a href="{% url 'equipes:evento' equipe.pk %}"><button >Editar Eventos</button></a>
    {% endif%}

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
    <script src="{% static 'js/evo-calendar.min.js' %}"></script>
    <script src="{% static 'js/demo.js' %}"></script>
    
    <script> 
        var t = JSON.parse('{{ eve | escapejs  }}');

        $(document).ready(function() {
            
            $("#demoEvoCalendar").evoCalendar("addCalendarEvent", t);
        });

    </script>
</section>

<hr>

<section>
    <header>
        <h3>Membros</h3>
    </header>
    <ul>
        {% if equipe.membro_set.all %}
            {% for membro in equipe.membro_set.all %}
            <p>
                <h4>{{ membro.nome }}</h4>
                <ul>
                    <li>Curso: {{ membro.curso }}</li>
                    <li>Ingressou na equipe em: {{ membro.entrada_equipe|date }} </li>
                    {% if perms.equipes.change_equipe %}
                        <li><a href="{% url 'equipes:delete-membro' membro.id %}">Remover</a></li>
                    {% endif%}
                </ul>
            </p>
            {% endfor %}
        {% else %}
            <p>Ainda não existe nenhum membro nesta equipe.</p>
        {% endif %}
    </ul>

    {% if perms.equipes.change_equipe %}
        <a href="{% url 'equipes:membro' equipe.pk %}"><button>Adicionar Membro</button></a>
    {% endif%}
</section>
<hr>
<section>
    <header>
        <h3>Fotos</h3>
    </header>
    <ul>
        {% if equipe.foto_set.all %}
            {% for foto in equipe.foto_set.all %}
            <img src="{{ foto.link }}">
            {% endfor %}
        {% else %}
            <p>Não há fotos para esta equipe.</p>
        {% endif %} 
    </ul>

    {% if perms.equipes.change_equipe %}
        <a href="{% url 'equipes:foto' equipe.pk %}"><button>Adicionar Foto</button></a>
    {% endif%}
</section>

{% endblock content %}